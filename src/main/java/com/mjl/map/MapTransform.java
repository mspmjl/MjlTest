package com.mjl.map;

import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;

/**
 * @author mjl
 * @date 2024/12/20.
 */
public class MapTransform {
    public static void main(String[] args) {

        StringBuilder sb = new StringBuilder();
        sb.append("114.41108218488392, 30.689467108333062;114.4006000375491, 30.685589207727833;114.38736099060414, 30.678770687104183;114.38212836100853, 30.67442318670434;114.37570619525658, 30.66878835694862;114.37119786939365, 30.662419226807984;114.36576563631372, 30.655294446802642;114.3624769398417, 30.649563498663916;114.3603590049408, 30.64262651637314;114.35786414104795, 30.64021190390578;114.3510214784868, 30.632511846950027;114.34425678884391, 30.625089926656585;114.33908138130928, 30.619853411549528;114.3334334650764, 30.61265436783011;114.33110415888902, 30.609339583295338;114.32671324155625, 30.60288319474269;114.31823692059466, 30.589915176398176;114.31435471367217, 30.584110288037458;114.31119115115769, 30.579586789340038;114.30953584359445, 30.580094972663346;114.30696013220569, 30.581037024568186;114.30382747140074, 30.581953573125837;114.3023016096615, 30.58311463606536;114.30095037851338, 30.584234957548993;114.29988417970358, 30.58508214632443;114.29963481009402, 30.585255702514875;114.29903195726628, 30.585751808783908;114.29822177552681, 30.586368770827967;114.29760670574414, 30.58675559421361;114.29658389509049, 30.587701466810874;114.29589857781691, 30.588385955652566;114.29565917939851, 30.588646241998262;114.29536148095251, 30.588895180473422;114.29471110776329, 30.58948196701829;114.29333301728043, 30.590761226967654;114.29166351649013, 30.5919965593165;114.29151206218114, 30.59208546843604;114.29121319593797, 30.592303310974245;114.29012489881264, 30.59296989207977;114.2887894778415, 30.59369864170976;114.28765042645486, 30.59426542588046;114.28584159847996, 30.59504545780037;114.28531564060387, 30.595355852318985;114.28471629116761, 30.59564059993758;114.28410688070964, 30.595954645116546;114.28327145658537, 30.596331637860025;114.28263285119831, 30.596647545913598;114.2821850459016, 30.59683219427205;114.28139363874732, 30.59719690482128;114.28048374509625, 30.597581819437195;114.2797219820238, 30.599462617644352;114.27831128305093, 30.602597536112505;114.28092966395141, 30.603567652982495;114.28612806810709, 30.605778820692787;114.28765267221863, 30.607092908546132;114.28840149969174, 30.60789008664803;114.28985468851523, 30.60957999838631;114.29219216928276, 30.611947285573795;114.29128506037877, 30.61298988042146;114.2888646660127, 30.615651483979583;114.28639854789614, 30.61773782491783;114.28582345270866, 30.61946120525087;114.28351714314233, 30.621948285008543;114.28062046719488, 30.6288618271765;114.28024398735563, 30.629717555810405;114.27864742897275, 30.629605686137307;114.27772657599448, 30.631480262789182;114.27691585527172, 30.632494756256914;114.27734003513353, 30.63290019328647;114.27657153476974, 30.634709995406233;114.27571742589086, 30.634808264577376;114.27513765951473, 30.63458158502514;114.27421626755314, 30.63538801179366;114.27348477737637, 30.634931935991766;114.27298648730998, 30.635462664771243;114.2724931379239, 30.636077364964667;114.27175571893076, 30.63696316951435;114.27068664554334, 30.63831652446228;114.27113166609297, 30.63862685657446;114.27304847039017, 30.639765483280335;114.27080019135978, 30.642611291727338;114.27151838661501, 30.643071913868187;114.27096053889333, 30.643727422737;114.27019464361551, 30.644717318844265;114.2683026325504, 30.64381581783062;114.2672676049418, 30.645103285449512;114.26611804338069, 30.644660227656654;114.26372792191029, 30.647920895506935;114.26837305970238, 30.650848558890633;114.27459211857851, 30.656484445214268;114.27903648508912, 30.65953835984919;114.28215540181976, 30.66220224257181;114.28620235797277, 30.665009874958756;114.29064169397253, 30.667893683426826;114.2936459869201, 30.669453396578568;114.30086800389812, 30.674803675618424;114.30197525526972, 30.67611704959801;114.30577598588243, 30.679711691595088;114.30788484789765, 30.679679157639423;114.30967274535416, 30.679898819860203;114.312967280812, 30.680616193247744;114.31574573975438, 30.68252564275601;114.31803318490499, 30.6839096437018;114.32171884258187, 30.68782666540483;114.32317283988031, 30.689979833169822;114.32453637781391, 30.691046111901027;114.32560599018466, 30.691442993738125;114.32672240427245, 30.691486237610246;114.32765241996692, 30.691498038448067;114.32862321873156, 30.69128593369331;114.33088631980284, 30.690010267386192;114.33226144587752, 30.688407411352237;114.3339298687012, 30.685460399752643;114.33431542142608, 30.684680405135683;114.33495896749344, 30.683568090435706;114.33556559320432, 30.682737145796356;114.33688044297928, 30.681023212317616;114.33738322457322, 30.68066130551923;114.33814489781513, 30.680208085397645;114.33887468121144, 30.67981232161222;114.33960338664112, 30.679593358013534;114.34068934817213, 30.67948558425671;114.34187169788437, 30.679609275597002;114.34292576956977, 30.679750281976833;114.34362141735672, 30.679999061448267;114.34434976346418, 30.6805420413611;114.34517665368612, 30.681228429402225;114.34585613197387, 30.6820791865641;114.34645395429077, 30.68306348382065;114.34703560710847, 30.684620232083276;114.34735881743096, 30.68544805467539;114.34781255154405, 30.686273773783025;114.34854125697376, 30.687093429786618;114.34941557772662, 30.687850811463054;114.35077516311597, 30.68898613515392;114.35310985913641, 30.690673917225293;114.35448759029705, 30.691635067806914;114.35541185683627, 30.692240479019233;114.35612591988615, 30.692867236291647;114.35724718482369, 30.693597011659808;114.35833781754336, 30.69409954415994;114.3600596895449, 30.695015942984682;114.36077456106975, 30.69522687495014;114.36155357160798, 30.69529969566779;114.363086080808, 30.694945528713674;114.36407242025797, 30.69449113416033;114.36589768722368, 30.695029528973663;114.36796792210198, 30.696380432439103;114.36899549377485, 30.697331433423283;114.36928070577426, 30.69745269507247;114.36986918571385, 30.697573956567762;114.3715079644557, 30.697533432576844;114.37184734427737, 30.697607726547048;114.37225795972599, 30.697805610622634;114.37279379896268, 30.69817055777815;114.3735822417088, 30.699165712913086;114.37552195279649, 30.70273751949357;114.37591603942371, 30.70322626384431;114.37634515996582, 30.703591578430252;114.37698888569427, 30.70384666126734;114.37797046412504, 30.703943074018646;114.3788810764205, 30.703915438811627;114.38316392760042, 30.702899373641408;114.38521772348788, 30.702511932391683;114.386717803859, 30.70216299327532;114.38934400001742, 30.701484440835166;114.39045304800003, 30.701555781834394;114.39402758528534, 30.701086513892616;114.39931968270572, 30.70018111912327;114.4049179226439, 30.69542243493943;114.41108218488392, 30.689467108333062");


        List<BasicLocation> list = new ArrayList<>();
        for (String s1 : sb.toString().split(";")) {
            String[] s2 = s1.split(",");
            BasicLocation basicLocation = new BasicLocation();

            double[] doubles = MapCoordinateConvertUtils.bd09Towgs84(Double.valueOf(s2[0]), Double.parseDouble(s2[1]));

            basicLocation.setLongitudeDone(doubles[0]);
            basicLocation.setLatitudeDone(doubles[1]);
            list.add(basicLocation);
        }
        String name = "江岸区";
        String objId = "fa488605ea7111e59c70b82a72d4c631";
        String collect = list.stream().map(o -> o.getLongitudeDone() + "," + o.getLatitudeDone()).collect(Collectors.joining(";"));
        System.out.println("update cloud_tenant_division set scope = '" + collect + "'  where name = '" + name + "';");
        System.out.println();
        String geoLocation = "GEOMETRYCOLLECTION(POLYGON((" + list.stream().map(o -> o.getLongitudeDone() + " " + o.getLatitudeDone()).collect(Collectors.joining(",")) + ")))";

        System.out.println("update common_geometry_info set geoLocation = ST_GEOMFROMTEXT('"+geoLocation+"') where objectId = '"+objId+"' and coordinateType = 'wgs84' and objectAttr = 'scope';");
    }
}
